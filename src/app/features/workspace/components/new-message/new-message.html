<section class="chat-container">
  <header class="chat-header">
    <span>Neue Nachricht</span>

    <div class="recipient-input" (click)="$event.stopPropagation()">
      <input
        type="text"
        [(ngModel)]="recipientText"
        placeholder="An: #channel, @jemand oder E-Mail"
        (keydown)="onRecipientKeyDown($event)"
        (input)="onRecipientInput()"
        (focus)="recipientFocused = true; onRecipientInput()"
        (blur)="onRecipientBlur()"
      />

      <app-mention-list
        *ngIf="showMention"
        class="mention-popover"
        [visible]="true"
        [mode]="mentionMode"
        [users]="mentionUsers"
        [channels]="mentionChannels"
        [searchTerm]="mentionSearch"
        [allowRawEmail]="true"
        (pick)="insertMention($event)"
        (userSelected)="onMentionUserPicked($event)"
        (channelSelected)="onMentionChannelPicked($event)"
      ></app-mention-list>
    </div>
  </header>

  <main></main>

  <footer class="footer">
    <div class="picked" *ngIf="selectedTargets.length > 0">
      <span>Senden an:</span>
      <ng-container *ngFor="let t of selectedTargets; let i = index">
        <span class="chip">
          {{ t.label }}
          <button type="button" class="chip-x" (click)="removeTarget(t)">Ã—</button>
        </span>
        <span *ngIf="i < selectedTargets.length - 1">, </span>
      </ng-container>
    </div>

    <app-message-area-component
      [recipientName]="selectedTargets.length === 1 ? selectedTargets[0].label : ''"
      [disabled]="selectedTargets.length === 0"
      (send)="handleSendFromFooter($event)"
      [placeholder]="'Starte eine neue Nachricht'"
    ></app-message-area-component>
  </footer>
</section>
